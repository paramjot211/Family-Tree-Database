/*LIST NAME OF PERSON who have born after 1990*/
SELECT FNAME, LNAME from person where DOB > TO_DATE('1989/12/31', 'YYYY/MM/DD');

/*COUNT NO OF FEMALES IN FAMILY TREE DATABASE*/
SELECT COUNT(*) from person where GENDER='F';

/* LIST OUT ALL THE PERSON WHOSE FIRST NAME START WITH L */
SELECT FNAME,LNAME FROM PERSON WHERE FNAME LIKE 'L%' OR FNAME LIKE 'l%';

/*FIND OUT MOTHER NAME OF Valerie Grange*/
SELECT FNAME,LNAME FROM person WHERE SSN IN (SELECT P2_SSN FROM person_mother_person WHERE P1_SSN = (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Valerie') AND UPPER(LNAME) = UPPER('Grange'))); 

/*LIST OUT COMPANY NAME AND CONTACT NUMBER OF COMPANIES FOR WHICH LUKE HILLS HAVE WORKED WITH*/
SELECT COMP_NAME,COMP_CONTACT_NO FROM company WHERE COMP_NO IN (SELECT COMP_NO FROM job WHERE PERSON_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills')));

/*LIST OUT QUALFICATIONS AND SCORE FOR QUALIFICATON FOR LUKE HILLS*/
SELECT DEGREE,GPA FROM education WHERE PERSON_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills'));

/*LIST OUT INSTITUTIONS AND THEIR CONTACT NUMBERS IN WHICH LUKE HILLS HAVE STUDIED*/
SELECT INST_NAME,INST_CONTACT_NO FROM institution WHERE INST_NO IN (SELECT INST_NO FROM education WHERE PERSON_SSN = (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills')));

/*LIST OUT IMPORTANT EVENTS FOR LUKE HILLS*/
SELECT EVENT_DATE,EVENT_DESC FROM event WHERE PERSON_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills'));

/*LIST OUT NAME OF PERSON WHO JACK HILLS HAVE DIVORCED WITH*/
SELECT FNAME,LNAME FROM person WHERE SSN IN (SELECT P2_SSN FROM person_divorces_person WHERE P1_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Jack') AND UPPER(LNAME) = UPPER('Hills')));
                
/*LIST OUT SPOUSE OF LUKE HILLS*/
SELECT FNAME,LNAME FROM person WHERE SSN IN(SELECT P2_SSN FROM person_marries_person WHERE P1_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills'))); 

/*LIST OUT ALL THE PERSON WHO ARE NOT CURRENTLY MARRIED*/
SELECT FNAME,LNAME FROM person WHERE SSN NOT IN(SELECT P2_SSN FROM person_marries_person UNION SELECT P1_SSN FROM person_marries_person); 

/*LIST OUT ALL THE PERSON WHO NEVER MARRIED*/
SELECT FNAME,LNAME FROM person WHERE SSN NOT IN(
    SELECT P2_SSN FROM person_marries_person 
    UNION 
    SELECT P1_SSN FROM person_marries_person
    UNION
    SELECT P1_SSN FROM person_divorces_person
    UNION
    SELECT P1_SSN FROM person_divorces_person);

/*LIST OUT NO OF PLACES LUKE HILLS HAVE LIVED IN */ 
SELECT COUNT(*) FROM residency WHERE PERSON_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills'));

/*HOW MANY CHILDREN LUKE HILLS HAVE */ 
SELECT COUNT(*) FROM Person_Father_Person WHERE P1_SSN IN((SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Luke') AND UPPER(LNAME) = UPPER('Hills')));

/*LIST CHILDREN OF VALERIE GRANGE WHO IS A MOTHER*/
SELECT FName, LName
FROM Person
WHERE SSN IN    (SELECT P2_SSN
                 FROM Person, Person_mother_Person
                 WHERE P1_SSN=SSN AND FName='Valerie'
                 AND LName='Grange');

/*LIST CHILDREN OF LUKE HILLS*/
SELECT FName, LName
FROM Person
WHERE SSN IN    (SELECT P2_SSN
                 FROM Person, Person_Father_Person
                 WHERE P1_SSN=SSN AND FName='Luke'
                 AND LName='Hills');

/*LIST PEOPLE RESIDING AT PINE STREET*/                 
SELECT FName, LName
FROM Person, Residency, Address
WHERE Residency.Address_No = Address.Address_No 
    AND Address_Line LIKE '%Pine%' AND Person_SSN = SSN;

/*LIST THE OLDEST ALIVE PERSON IN THE DATABASE*/
SELECT FName, LName, Dob
FROM Person
WHERE Dob = (SELECT MIN(Dob) FROM Person WHERE Dod IS NULL);

/*LIST THE AGE OF THE YOUNGEST PERSON IN THE DATABASE*/
SELECT ROUND((SYSDATE-Dob)/365, 0) AS Age
FROM Person
WHERE Dob = (SELECT MAX(Dob) FROM Person WHERE Dod IS NULL);

/*LIST INFORMATION ABOUT LUKE'S CURRENT JOB*/
SELECT FName, LName, Comp_Name, Position, ROUND((SYSDATE-Start_Date)/365, 0) AS "# of years"
FROM Person, Company, Job
WHERE FName = 'Luke' AND Company.Comp_No = Job.Comp_No AND Person_SSN = SSN AND End_Date IS NULL;

/*UPDATE FIRST NAME OF Valerie Grange TO Selena Grange*/
UPDATE person SET FNAME = 'Selena' WHERE UPPER(FNAME) = UPPER('Valerie') AND UPPER(LNAME) = UPPER('Grange');

/*DELETE CURRENT SPOUSE FOR ANN CRIDER*/
DELETE FROM person_marries_person where P1_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Ann') AND UPPER(LNAME) = UPPER('Crider')) 
OR P2_SSN IN (SELECT SSN FROM person WHERE UPPER(FNAME) = UPPER('Ann') AND UPPER(LNAME) = UPPER('Crider'));

/*USING VIEW - LIST OUT PERSON AND THEIR FATHER'S NAME WHOSE PERSON NAME START WITH L*/
 SELECT PERSON_FNAME,PERSON_LNAME,FATHER_FNAME,FATHER_LNAME from view_person_father WHERE PERSON_FNAME like 'L%';  